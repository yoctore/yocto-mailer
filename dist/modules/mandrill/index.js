"use strict";function MandrillWrapper(){this.mandrill_client={},this.mailOptions={from_name:"",from_email:"",to:[],subject:"",html:""},this.defaultMailOption=_.omit(_.clone(this.mailOptions),["from_email","from_name"]),this.logger=logger}var mandrill=require("mandrill-api/mandrill"),_=require("lodash"),logger=require("yocto-logger");MandrillWrapper.prototype.setConfig=function(a){return _.isString(a)?(this.mandrill_client=new mandrill.Mandrill(a),!0):void this.logger.error("[ MandrillWrapper.setConfig ] - The api key should be a String")},MandrillWrapper.prototype.send=function(a,b,c,d){function e(a){a.logger.debug("[ MandrillWrapper.deleteMailOptions ] - Delete mail otpions"),_.extend(a.mailOptions,a.defaultMailOption),a.mailOptions.to=[]}if(this.logger.debug("[ MandrillWrapper.send ] - Try sending a new email"),this.mailOptions.html=_.isString(b)?b:"",this.mailOptions.subject=_.isString(a)?a:"",c=!_.isUndefined(c)&&_.isFunction(c)?c:function(a){this.logger.info("[ MandrillWrapper.send.defaultCallBackSendMail ] -  sending message, info details id : "+a)},d=!_.isUndefined(d)&&_.isFunction(d)?d:function(a){this.logger.info("[ MandrillWrapper.send.defaultCallBackSendMail ] -  sending message, error details id : "+a)},_.isEmpty(this.mandrill_client)||_.isEmpty(this.mailOptions.to)||_.isEmpty(this.mailOptions.from_email)||_.isEmpty(this.mailOptions.subject)||_.isEmpty(this.mailOptions.html))this.logger.error("[ MandrillWrapper.send ] - can't send mail, please check configuration."),e(this);else{var f=_.clone(this.mailOptions);e(this),this.mandrill_client.messages.send({message:f,async:!1},function(a){c(a)},function(a){d(a)})}},module.exports=new MandrillWrapper;